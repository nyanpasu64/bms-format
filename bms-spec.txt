endian=big

// header = jump addrs
tracks = {
	u8 	0xC1
	u8 	channel
	u24	addr
} * tracknum
u8 0xFE

for track in tracks {
	goto track.addr

	var notes[8]	// which pitch to turn off?
	            	// 1..7

	Loop:
	for {
		switch ev {
		case ev < 0x80:
			u8 poly_id
			var note = ev
			u8 velocity
	
	
			note_on(dtime, note, velocity)
			notes[poly_id] = note
	
		case 0x81 <= ev < 0x88:
			var note = notes[ev % 8]
			note_off(dtime, note)


	    // ties

        case 0x80:
            u8 delay

		case 0x88:
			u16 delay

		case 0xEA:      // arookas
		    u24 delay

        case 0xCF:      // arookas
            panic

		case 0xF0:
			vlq tie		// 0b 1xxxxxxx 0xxxxxxx big-endian
		
		// UNKNOWN COMMANDS

		case 0xB1:
			u8 unknown
			u8 flag
			switch (flag) {
			case 0x40:
				drop 2
			case 0x80:
				drop 4
			}
	
		case 0x98: drop 2
		case 0x9A: drop 3
		case 0x9C: drop 3
		case 0x9E: drop 4
		case 0xA0: drop 2
		case 0xA3: drop 2
		case 0xA4: drop 2
		case 0xA5: drop 2
		case 0xA7: drop 2
		case 0xA9: drop 4
		case 0xAA: drop 4
		case 0xAC: drop 3
		case 0xAD: drop 3
		case 0xB8: drop 2
		case 0xC2: drop 1
		case 0xC4: drop 4
		case 0xC5: drop 3
		case 0xC6: drop 1
		case 0xC7: drop 4
		case 0xC8: drop 4
		case 0xCB: drop 2
		case 0xCC: drop 2
		case 0xCF: drop 1
		case 0xD0: drop 2
		case 0xD1: drop 2
		case 0xD2: drop 2
		case 0xD5: drop 2
		case 0xDA: drop 1
		case 0xDB: drop 1
		case 0xDD: drop 3
		case 0xDF: drop 4
		case 0xE0: drop 3
		case 0xE6: drop 2
		case 0xE7: drop 2
		case 0xEF: drop 3
		case 0xF1: drop 1
		case 0xF4: drop 1
		case 0xF9: drop 2
		case 0xFD: drop 2
		case 0xFE: drop 2
	
		case 0xFF:
			break Loop

		default:
			log
		}
	}

}